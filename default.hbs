<!DOCTYPE html>
<html lang="{{@site.locale}}" class="transition-colors duration-500">
<head>
    <title>{{meta_title}}</title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
   <script>
    (function () {
      const theme = localStorage.getItem('theme');
      const system = window.matchMedia('(prefers-color-scheme: dark)').matches;
      const mode = theme === 'dark' || (!theme && system) ? 'dark' : 'light';
      document.documentElement.classList.toggle('dark', mode === 'dark');
    })();
  </script>
    <link rel="stylesheet" href="{{asset "/built/css/output.min.css"}}">
    {{ghost_head}}
</head>
<body class="bg-slate-200 dark:bg-slate-900 container mx-auto {{#match @custom.body_font "Nunito"}} font-nunito {{/match}}">
  <div class="lg:px-5 px-2">
    {{!-- The main content area --}}
    <header id="site-header" class="z-50 mt-4 mb-4 mx-auto w-full rounded-full transition-all duration-500 ease-in-out translate-y-0 lg:sticky lg:top-4">
        <div class="bg-slate-100 dark:bg-slate-800 rounded-full transition-all duration-500 ease-in-out">
          <div class="flex items-center justify-between px-2 py-2 lg:px-6 lg:py-2">
            {{!-- logo --}}
            <div class="w-auto px-2">
              <div class="flex flex-wrap items-center">
                <div class="w-16">
                  <a href="{{@site.url}}">
                    {{#if @site.logo}}
                      <img width="100%" height="100%" src="{{@site.logo}}" alt="{{@site.title}}">
                    {{else}}
                      {{@site.title}}
                    {{/if}}
                  </a>
                </div>
              </div>
            </div>
            {{#match @custom.navigation_layout "Logo in the middle"}} 
            {{!-- search --}}
            <div class="w-auto order-last">
              <div class="flex flex-wrap items-center">
                <div class="w-auto dark:mr-4">
                  <div class="flex flex-wrap -m-2">
                    <div class="w-full flex md:w-auto p-2">
                      <button class="rounded-full " aria-label="icon for search" data-ghost-search>
                        <img src="./assets/icons/icon_search.webp" width="48" height="48" alt="icône de recherche rouge">
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            {{/match}}
            {{!-- menu hamburger--}}
            <div class="w-auto {{#match @custom.navigation_layout "Logo in the middle"}}order-first{{/match}}">
              <div class="flex flex-wrap items-center">
                {{#match @custom.navigation_layout "Logo in the left"}} 
                <div class="w-auto dark:mr-4">
                  <div class="flex flex-wrap -m-2">
                    <div class="w-full flex md:w-auto p-2">
                      <button class="rounded-full " aria-label="icon for search" data-ghost-search>
                        <img src="/assets/icons/icon_search.webp" width="48" height="48" alt="icône de recherche rouge">
                      </button>
                    </div>
                  </div>
                </div>
                {{/match}}
                <div class="w-auto">
                  <div class="flex flex-wrap -m-2">
                    <div class="w-full flex md:w-auto p-2">
                      <button class="rounded-full navbar-burger" aria-label="burger menu">
                        <img src="/assets/icons/menu.webp" width="56" height="56" alt="icône de menu bleu foncé">
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
        </div>
    </header>
    <div class="hidden navbar-menu fixed top-0 left-0 w-full h-full z-[999] bg-slate-200 dark:bg-slate-900 overflow-y-auto">
      <div class="navbar-backdrop fixed inset-0"></div>
        <nav class="relative z-10 px-6 pt-6">
          <div class="flex flex-wrap justify-between h-full">
            <div class="w-full">
              <div class="flex items-center justify-between -m-2">
                <div class="w-24 p-2">
                  <a href="{{@site.url}}">
                      {{#if @site.logo}}
                          <img width="100%" height="100%" src="{{@site.logo}}" alt="{{@site.title}}">
                      {{else}}
                          {{@site.title}}
                      {{/if}}
                  </a>
                </div>
                <div class="w-auto p-2">
                  <a class="inline-block navbar-close dark:bg-slate-200 dark:rounded-full dark:p-1" href="#">
                    {{> "icons/close"}}
                  </a>
                </div>
              </div>
            </div>
          </div>
          <div class="flex flex-col justify-between h-[80vh]">
            <div class="flex justify-center py-8 w-full">
            {{navigation}}
            </div>
            <!-- Connexion / compte centrée en bas -->
            <div class="flex flex-col items-center justify-end w-full pb-8">
              <div class="w-auto max-w-md px-5">
                {{#unless @member}}
                  {{#unless @site.members_invite_only}}
                    <a class="block w-full px-4 py-2.5 text-lg xl:text-xl text-center text-slate-900 font-bold bg-slate-100 hover:bg-slate-200 focus:ring-4 focus:ring-slate-200 rounded-full" href="#/portal/signin" data-portal="signin">
                      {{t "Sign in"}}
                    </a>
                  {{else}}
                    <a class="block w-full px-4 py-2.5 text-lg xl:text-xl text-center text-slate-900 font-bold bg-slate-100 hover:bg-slate-200 focus:ring-4 focus:ring-slate-200 rounded-full" href="#/portal/signin" data-portal="signin">
                      {{t "Sign in"}}
                    </a>
                  {{/unless}}
                {{else}}
                  <a class="block w-full px-4 py-2.5 text-lg xl:text-xl text-center text-white font-bold rounded-full hover:opacity-75" style='background-color:{{@site.accent_color}};' href="#/portal/account" data-portal="account">
                    {{t "Account"}}
                  </a>
                {{/unless}}
              </div>
            </div>
          </div>
        </nav>
    </div>
    <div class="site-content">
        {{{body}}}
    </div>
    {{!-- The global footer at the very bottom of the screen --}}
        <footer class="container mx-auto mt-6">
            <div class="p-4 mb-4 bg-slate-100 dark:bg-slate-800  rounded-3xl">
                <div class="mx-auto ">
                    <div class="flex flex-col flex-wrap items-center justify-center ">
                        <div class="w-16">
                            <a href="{{@site.url}}">
                              {{#if @site.logo}}
                                  <img width="100%" height="100%" src="{{@site.logo}}" alt="{{@site.title}}">
                              {{else}}
                                  {{@site.title}}
                              {{/if}}
                            </a> 
                        </div>

                        <nav class="m-5">
                            {{navigation type="secondary"}}
                        </nav>

                        <div class="w-auto p-4">
                          <div class="flex flex-wrap -m-4">
                            {{!-- Darkmode option --}}
                              <div id="theme-switcher" class="relative inline-block">
                                <button id="theme-dropdown-btn"
                                        class="flex items-center gap-2 px-3 py-2 bg-slate-100 dark:bg-slate-800 text-slate-900 dark:text-white rounded-full border border-slate-300 dark:border-slate-700 hover:ring-2 hover:ring-slate-400 dark:hover:ring-slate-500 transition"
                                        aria-haspopup="listbox" aria-expanded="false">
                                  <img id="theme-icon" src="/assets/icons/system.svg" alt="Thème actuel" class="w-5 h-5">
                                  <span id="theme-label" class="text-sm font-medium">Système</span>
                                  <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-width="2" d="M19 9l-7 7-7-7" />
                                  </svg>
                                </button>
                                <ul id="theme-options"
                                    class="absolute z-10 hidden mt-2 w-44 bg-white dark:bg-slate-900 rounded-lg border border-slate-200 dark:border-slate-700 shadow-lg">
                                  <li data-theme="light" class="flex items-center gap-2 px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 dark:text-white cursor-pointer">
                                    <img src="/assets/icons/light.webp" alt="Clair" class="w-4 h-4"> Clair
                                  </li>
                                  <li data-theme="dark" class="flex items-center gap-2 px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 dark:text-white cursor-pointer">
                                    <img src="/assets/icons/moon.webp" alt="Sombre" class="w-4 h-4"> Sombre
                                  </li>
                                  <li data-theme="system" class="flex items-center gap-2 px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 dark:text-white cursor-pointer">
                                    <img src="/assets/icons/system.webp" alt="Système" class="w-4 h-4"> Système
                                  </li>
                                </ul>
                              </div>
                          </div>
                      </div>
                    </div>
                </div>
            </div>
            <div>
              <p class="text-sm text-center mb-12 mt-12">
                <a class="text-black dark:text-white" href="https://ghost.org/" target="_blank" rel="noopener">
                  Powered by Ghost
                </a>
              </p>
            </div>
        </footer>
  {{!-- Scripts - handle member signups, responsive videos, infinite scroll, floating headers, and galleries --}}
  <script
      src="https://code.jquery.com/jquery-3.5.1.min.js"
      integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
      crossorigin="anonymous">
  </script>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
  const burger = document.querySelector('.navbar-burger');
  const menu = document.querySelector('.navbar-menu');
  const close = document.querySelector('.navbar-close');
  const backdrop = document.querySelector('.navbar-backdrop');
  const header = document.getElementById('site-header');

  let isHeaderVisible = true;
  let lastScrollTop = 0;
  let mouseLastMoved = Date.now();
  let inactivityTimer;
  let scrollPosition = 0;

  function getScrollbarWidth() {
    return window.innerWidth - document.documentElement.clientWidth;
  }

  // --- MENU BURGER ----
  function openMenu() {
    if (menu) {
      scrollPosition = window.scrollY;

      // Bloque le scroll et garde la position visuellement
      document.body.style.position = 'fixed';
      document.body.style.top = `-${scrollPosition}px`;
      document.body.style.left = '0';
      document.body.style.right = '0';
      document.body.style.width = '100%';

      menu.classList.remove('hidden', 'animate-slide-fade-out');
      void menu.offsetWidth;
      menu.classList.add(
        'fixed',
        'inset-0',
        'w-screen',
        'h-screen',
        'z-[999]',
        'animate-slide-fade-in'
      );
    }
  }

  function closeMenu() {
    if (menu) {
      menu.classList.remove('animate-slide-fade-in');
      menu.classList.add('animate-slide-fade-out');

      setTimeout(() => {
        menu.classList.add('hidden');
        menu.classList.remove(
          'fixed',
          'inset-0',
          'w-screen',
          'h-screen',
          'z-[999]'
        );

        // Restaure la position scroll sans effet de saut
        const scrollY = parseInt(document.body.style.top || '0') * -1;
        document.body.style.position = '';
        document.body.style.top = '';
        document.body.style.left = '';
        document.body.style.right = '';
        document.body.style.width = '';
        window.scrollTo(0, scrollY);
      }, 300);
    }
  }

  // --- HEADER VISIBILITY ---
  function showHeader() {
    if (!isHeaderVisible) {
      header.classList.remove('translate-y-neg-120');
      isHeaderVisible = true;
    }
  }

  function hideHeader() {
    const scrollTop = window.scrollY;
    if (
      isHeaderVisible &&
      scrollTop > 0 &&
      header.classList.contains('w-[30%]')
    ) {
      header.classList.add('translate-y-neg-120');
      isHeaderVisible = false;
    }
  }

  function resetInactivityTimer() {
    if (inactivityTimer) clearTimeout(inactivityTimer);
    inactivityTimer = setTimeout(() => {
      hideHeader();
    }, 2000);
  }

  // --- HEADER WIDTH ---
  function updateHeaderWidth() {
    const scrollTop = window.scrollY;
    const isDesktop = window.innerWidth > 768;

    if (!isDesktop) return;

    if (scrollTop === 0) {
      header.classList.add('w-full', 'py-2');
      header.classList.remove('w-[30%]', 'shadow-md');
      showHeader(); // Toujours visible en haut de page
    } else {
      const wasCompact = header.classList.contains('w-[30%]');
      header.classList.add('w-[30%]', 'shadow-md');
      header.classList.remove('w-full', 'py-2');

      // Si on vient juste de compacter → lancer timer
      if (!wasCompact) {
        resetInactivityTimer();
      }
    }
  }

  // --- ÉVÉNEMENTS ---
  if (burger) burger.addEventListener('click', openMenu);
  if (close) close.addEventListener('click', closeMenu);
  if (backdrop) backdrop.addEventListener('click', closeMenu);

  window.addEventListener('scroll', () => {
    updateHeaderWidth();
    // On ne reset pas l'inactivité ici (plus de disparition au scroll seul)
  });

  window.addEventListener('mousemove', () => {
    mouseLastMoved = Date.now();
    showHeader();

    if (header.classList.contains('w-[30%]')) {
      resetInactivityTimer();
    }
  });

  window.addEventListener('resize', updateHeaderWidth);

  // --- INIT ---
  updateHeaderWidth();
  showHeader();
});
  </script>
  
  <script src="{{asset "built/js/all.min.js"}}"></script>
  <script>
    $(document).ready(function () {
        // FitVids - Makes video embeds responsive
        $(".gh-content").fitVids();
    });
  </script>
  {{!-- Ghost outputs required functional scripts with this tag - it should always be the last thing before the closing body tag --}}
  {{ghost_foot}}
 </div> 
</body>
</html>
